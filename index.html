<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="./stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./stylesheets/print.css" media="print">
    <link rel="stylesheet" type="text/css" href="./stylesheets/issues.css" media="screen">
    <link rel="stylesheet" type="text/css" href="./stylesheets/prism.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="./javascripts/footnoter.js"></script>
    <script src="./javascripts/prism.min.js"></script>
    <script src="./javascripts/marked.js"></script>
    <script type="text/javascript">
      $(document).ready(function()  {
        $.getJSON("https://api.github.com/repos/gappleto97/Senior-Project/issues?state=open", function (allIssues) {
          $.each(allIssues, function (i, issue) {
            appendstring = "<div class=\"issue\">"+ "<b><a href=\"" + issue.html_url + "\">" + issue.number
                + " - " + issue.title;
            if (issue.labels.length > 0)
                appendstring = appendstring + " -";
            for (var i = 0; i < issue.labels.length; i++)	{
                label = issue.labels[i];
                appendstring = appendstring + " <span style=\"border-color:#" + label.color
                    + ";background:#" + label.color + "\">" + label.name + "</span>";
            };
            appendstring = appendstring + "</a></b></br>" + "<i>Updated at "
                + issue.updated_at.replace("T"," ").replace("Z"," UTC") + "</i></br>"
                + marked(issue.body) + "</div>";
            $("#issuesection").append(appendstring);
          });
          Prism.highlightAll();
        });
      });
    </script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Senior Project by gappleto97</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Senior Project</h1>
        <h2></h2>
        <a href="https://github.com/gappleto97/Senior-Project" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p>To see the original version of this <a href="old.html">click here</a>.</p>

<h2>
<a id="abstract" class="anchor" href="#abstract" aria-hidden="true"><span class="octicon octicon-link"></span></a>Abstract</h2>

<p>A generalized, peer-to-peer platform for programs like Folding at Home, which rewards users with micropayments for solving NP problems.</p>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>With the rise of distributed computing projects, from <a href="https://folding.stanford.edu/">Folding at Home</a>, <a href="http://setiathome.ssl.berkeley.edu/">SETI</a>, etc., there is a distinct lack of standardization in their distribution methods. Because of this, anyone who wants to tap into this trove of information must design their own platform and market this to the world. It’s not surprising that it’s been slow to diversify.</p>

<p>Another problem is that clients have no incentive to run these programs, save for charitable inclinations. Until recently, it would have been next to impossible to provide an incentive. However, with the onset of cryptocurrencies, there is now an easy solution. If people are provided a reward for problems, they can gain a passive income for their idle resources. This becomes their incentive.<script type="text/javascript">addFootnote("Users will have the option of running this for free. The bounty is to encourage participation, and is not strictly necessary.");</script></p>

<h2>
<a id="design" class="anchor" href="#design" aria-hidden="true"><span class="octicon octicon-link"></span></a>Design Goals</h2>

<p>Because this platform will involve a great number of moving parts, and because it will be dealing with people's money, it is important that there is no central point of failure. While this may complicate things, it is very important to me that I make this platform as robust as I can before it is opened for public development. That means that it must be decentralized, flexible, and secure.</p>

<p>There are five attacks that I currently anticipate on this platform. Each of them must be addressed in its design, and throughout this proposal I will point out when they are.</p>

<ol>
	<li><a id="MalliciousUser"></a>Mallicious user
		<ul>
			<li>This is a Denial of Service attack on the servers. By spoofing an active user (not solving the problems it is sent), an attacker could waste the money and processing time of the server.</li>
		</ul>
	</li>
	<li><a id="MallicousServer"></a>Mallicious server
		<ul>
			<li>This is a Denial of Service attack on the user and charity servers (one which does not pay). By spoofing a charity server, an attacker could send useless programs, which, for instance, add random sums forever. Such an attack would go against the wishes of the user (not contributing towards general research), and force real charity servers to provide payment which they may not be able to afford.</li>
		</ul>
	</li>
	<li><a id="DishonestServer"></a>Dishonest server
		<ul>
			<li>This is a Denial of Service attack on the user and platform. By broadcasting a bounty with a substantial reward, an attacker could trick nodes into wasting their computational time. This would drive up the general price of the platform, and possibly force it to a halt.</li>
		</ul>
	</li>
	<li><a id="OutsideActors"></a>Outside actors
		<ul>
			<li>It is very possible that an outside bad actor could misuse the platform. One such misuse could be hiring out a botnet.</li>
		</ul>
	</li>
	<li><a id="BountySpammers"></a>Bounty spammers
		<ul>
			<li>This is an attempt to overwhelm the user end of the network. If they spend all their time verifying incoming bounties, the network cannot function properly. This does not yet have a proposed solution.</li>
		</ul>
	</li>
</ol>

<h2>
<a id="security" class="anchor" href="#security" aria-hidden="true"><span class="octicon octicon-link"></span></a>Security</h2>

<p>Because a client is allowing other people to run unknown code on their computer, there needs to be a way to keep things secure. This is possible by the use of a sandbox, making Java an ideal language for this platform. While this is less efficient than other languages, it builds a security solution into the network and client itself. This is a solution for the <a href="#OutsideActors">Outside Actor</a> problem.</p>

<p>There will also be cases where one will want to run it in a bigger sandbox. Support for this type of operation is critical for companies like Intel, AMD, NVidia, and Samsung, which may want to test edge cases of their products in the wild. If everything is completely sandboxed, there’s no way for them to easily guarantee that they are getting to the correct devices. These use cases will be investigated, as they could make up most of the demand for this network. If they are feasible, a permissioning system will be used to select different security policies for each program.</p>

<h2>
<a id="bounties" class="anchor" href="#bounties" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bounties</h2>

<p>A bounty is the mechanism by which one notifies the network of a new problem to solve. It is sent as an object with all the data a user needs to verify, prioritize, connect to the sending server, and select the proper security policy.</p>

<p><script type="text/javascript">document.write(marked("```python\n\"\"\"An object representation of a Bounty\nParts:\nip         -- The ip address of the requesting node\nbtc        -- The Bitcoin address of the requesting party\nreward     -- The reward amount in satoshis to be given over 24 hours\n               (x | x == 0 or 1440 <= x <= 100000000) (1440 is 1 satoshi/minute)\nident      -- A value set by the issuer to determine which problem/test to send\ntimeout    -- Unix time at which the bounty expires (defaults to 24 hours)\ndata       -- A dictionary containing optional, additional information\n    author -- String which represents the group providing the Bounty\n    reqs   -- Dict containing requirements keyed by the related python calls\n               (\"sys.platform\":\"win32\")\n    perms  -- Dict containing the minimum required security policies\n               (if empty, most restrictive assumed)\n    key    -- A tuple which contains the RSA n and e values for this Bounty\n               (required only when reward is 0)\n    sig    -- A Bytes object of the Bounty's print output signed by the above key\n               (required only when reward is 0)\n    TDL    -- More to be defined in later versions\n\"\"\"\n```"));</script></p>

<p>There are two tools used to validate a bounty. It comes with an object method to validate itself to the minimum definition, and there is also an external method which the user can change as needed. This allows a user to filter out the IPs of known attackers, or permissions that it cannot use.</p>

<p>The object verification method checks four things. First it checks if the IP address is in the valid IPv4 range. Second, it checks if the Bitcoin address is in the proper namespace (but does not check if it has enough funds until later). Next, it checks if the reward is in the valid range. Finally, it checks the timeout value. If all of these are valid, it propagates the bounty to its peers. This shallow check takes ~239μs to complete.<script type="text/javascript">addFootnote("Average of 1000 tries on my Asus Q550LF running Linux Mint 17.2 (KDE), Python 3.4.3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;855μs on Python 2.7.6");</script></p>

<h2>
<a id="Certificates" class="anchor" href="#Certificates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Charities</h2>

<p>The <a href="#MallicousServer">Mallicious Server</a> problem and Man-in-the-Middle attack forces an extra step for non-paying servers and relayed bounties (read: ones that were not sent directly by the issuer). In order to distinguish between attackers and genuine bounties, they must be vetted by a third party. This can be done by making a certificate authority. If a user encounters an unpaid bounty, the user will verify its certificate. It does this as follows:</p>

<p><script type="text/javascript">document.write(marked("```python\ndef checkSign(self):\n	try:\n		from rsa import verify, PublicKey\n		expected = str(self.data.get('key')).encode('utf-8')\n		if verify(expected,self.data.get('cert'),authority_key):\n			expected = str(self).encode('utf-8')\n			n = self.data.get('key')[0]\n			e = self.data.get('key')[1]\n			return verify(expected,self.data.get('sig'),PublicKey(n,e))\n		return False\n	except:\n		return False\n```"));</script></p>

<p>In the worse case scenario (the bounty contains a certificate and signature, but is invalid), this verification takes an additional 340μs.<script type="text/javascript">addFootnote("Average of 1000 tries on my Asus Q550LF running Linux Mint 17.2 (KDE), Python 3.4.3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;194μs on Python 2.7.6");</script> While this is by no means ideal, it is (as of yet) the best available solution. The certificate authority will be spun off to the overall Bitcoin community in order to keep some element of decentralization.</p>

<h2>
<a id="tests" class="anchor" href="#tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tests</h2>

<p>Tests are a vital part of the network. Like there are ways for clients to exclude invalid requests, there must also be a way for servers to exclude inappropriate clients. They can do this with permissions, requirements, and small bits of test code.</p>

<p>Before the user follows through on a bounty, it checks the <code>data['reqs']</code> and <code>data['perms']</code> fields.<script type="text/javascript">addFootnote("Due to a limitation in my <code>call</code> module, checking the Java version must be done in the test program");</script> If the user does not fit the desired client, or the server is requesting too large a sandbox, the user will not follow through.</p> 

<p>This connection is made by sending a specified header, an instance of the Bounty object, and a dict of the client's system info. This allows the server to determine which test/query combination to use. After parsing this request, the server will send the test code.</p>

<p>The client sends the server the output of this code, and if it is correct, is sent the query.</p>

<h2>
<a id="queries" class="anchor" href="#queries" aria-hidden="true"><span class="octicon octicon-link"></span></a>Queries</h2>

<p>After all of this, the query is finally sent to the client. Simultaneously, a <a href="https://bitcoin.org/en/developer-guide#micropayment-channel">payment channel</a><script type="text/javascript">addFootnote("This opens up a security risk to the user because their private key is exposed to my program. This is the single biggest reason that this must be an open source project. Encryption will be explored.");</script> is opened.</p>

<p><img src="https://bitcoin.org/img/dev/en-micropayment-channel.svg" alt="payment channel"/></p>

<p>This channel will be updated once per minute as long as there is an active connection between the server and user, and will grow at a linear rate until a result is achieved, but will never reach the full bounty until a result is submitted. This is to protect from fraud on both the server and user end. The server is protected in that the user has an incentive to stay online, and the user is protected in that the connection will expire if a predetermined time goes by without a result. This is a solution to the <a href="#DishonestServer">Dishonest Server</a> problem.</p>

<p>In addition to this, the server can implement a flagging system. By making their program print a predetermined flag, they can request the user to send the following line to the server. This gives the server both an indication that the user is still working, and an estimation of their speed. This is a solution to the <a href="#MalliciousUser">Mallicious User</a> problem.</p>

<p>Upon closing the connection, the reward is distributed between the two parties in the way agreed upon in the last transaction broadcast. If a result is given, the full bounty will be delivered. The transactions are always broadcast with a lock-time of 24 hours.

<h1>
<a id="Scale" class="anchor" href="#Scale" aria-hidden="true"><span class="octicon octicon-link"></span></a>Proposed Grading Scale</h1>

<p>The project would be graded according to the following scale, where 1 point is 1%, and all points above 100 are discounted.</p>

<p><table>
	<tr>
		<th class="grade-cat"><strong>Goal</strong></th>
		<th><strong>Points</strong></th>
	</tr>
	<tr>
		<td class="grade-cat">Network Communications</td>
		<td>20</td>
	</tr>
	<tr>
		<td class="grade-cat">Port Forwarding (Linux, OSX)</td>
		<td>5</td>
	</tr>
	<tr>
		<td class="grade-cat">Port Forwarding (Windows)<script type="text/javascript">addFootnote("The additional points are for solving a dependency issue where MiniUPNPc does not compile properly on Windows. Because I have no experience in making C-code into python modules, this will be especially difficult");</script></td>
		<td>15</td>
	</tr>
	<tr>
		<td class="grade-cat">Peer Discovery</td>
		<td>10</td>
	</tr>
	<tr>
		<td class="grade-cat">Execution of Bounties</td>
		<td>15</td>
	</tr>
	<tr>
		<td class="grade-cat">Flagging System for Bounties</td>
		<td>7</td>
	</tr>
	<tr>
		<td class="grade-cat">Working Paid Example Server</td>
		<td>3</td>
	</tr>
	<tr>
		<td class="grade-cat">Working Charity Example Server</td>
		<td>2</td>
	</tr>
	<tr>
		<td class="grade-cat">Coin Control</td>
		<td>25</td>
	</tr>
	<tr>
		<td class="grade-cat">Signature Authority</td>
		<td>15</td>
	</tr>
	<tr>
		<td class="grade-cat">Rough GUI</td>
		<td>5</td>
	</tr>
	<tr>
		<td class="grade-cat">Show Bounty Queue</td>
		<td>5</td>
	</tr>
	<tr>
		<td class="grade-cat">Hide to Tray</td>
		<td>2</td>
	</tr>
	<tr>
		<td class="grade-cat">Notifications</td>
		<td>1</td>
	</tr>
	<tr>
		<td class="grade-cat">Additional Wallet Utilities</td>
		<td>5</td>
	</tr>
	<tr>
		<th class="grade-cat"><strong>Max Earnable</strong></th>
		<th><strong>100</strong></th>
	</tr>
	<tr>
		<th class="grade-cat"><strong>Total</strong></th>
		<th><strong>135</strong></th>
	</tr>
</table></p>

<h1>
<a id="Dependencies" class="anchor" href="#Dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dependencies</h1>
<!---<h2>Included</h2>
<ul>
</ul>--->

<h2>Required</h2>
<ul>
	<li>Java</li>
	<li>pycoin</li>
	<li>rsa</li>
	<ul>
		<li>pyasn</li>
	</ul>
</ul>

<h2>Recommended</h2>
<ul>
	<li>MiniUPNPc</li>
</ul>

<div id="progresssection">

	<h1>
	<a id="progress" class="anchor" href="#progress" aria-hidden="true"><span class="octicon octicon-link"></span></a>Progress</h1>
	
	<h2>
	Current Compatability</h2>
	<p><a href="https://travis-ci.org/gappleto97/Senior-Project" target="_blank"><img src="https://img.shields.io/travis/gappleto97/Senior-Project/master.svg?style=flat&label=Linux/OSX%20Build" alt=""></img></a> <a href="https://ci.appveyor.com/project/gappleto97/senior-project" target="_blank"><img src="https://img.shields.io/appveyor/ci/gappleto97/Senior-Project/master.svg?style=flat&label=Windows%20Build" alt=""></img></a> <a href="https://codecov.io/github/gappleto97/Senior-Project" target="_blank"><img src="https://img.shields.io/codecov/c/github/gappleto97/Senior-Project/master.svg?style=flat&label=Coverage" alt=""></img></a></p>
	
	<p><table>
		<tr>
			<td></td>
			<th>Python 2.6</th>
			<th>Python 2.7</th>
			<th>Python 3.3</th>
			<th>Python 3.4</th>
			<th>Python 3.5</th>
			<th>Pypy 2</th>
			<th>Pypy 3</th>
		</tr>
		<tr>
			<th>Linux</th>
			<td style="background:#008000"></td>
			<td style="background:#008000"></td>
			<td style="background:#107000"></td>
			<td style="background:#107000"></td>
			<td style="background:#107000"></td>
			<td style="background:#008000"></td>
			<td style="background:#107000"></td>
		</tr>
		<tr>
			<th>Windows</th>
			<td style="background:#206000"></td>
			<td style="background:#206000"></td>
			<td style="background:#305000"></td>
			<td style="background:#305000"></td>
			<td style="background:#305000"></td>
			<td style="background:#206000"></td>
			<td style="background:#305000"></td>
		</tr>
		<tr>
			<th>OSX</th>
			<td style="background:#008000"></td>
			<td style="background:#008000"></td>
			<td style="background:#107000"></td>
			<td style="background:#107000"></td>
			<td style="background:#107000"></td>
			<td style="background:#008000"></td>
			<td style="background:#107000"></td>
		</tr>
	</table></p>
	<h2>
	<a id="so-far" class="anchor" href="#so-far" aria-hidden="true"><span class="octicon octicon-link"></span></a>So Far</h2>
	
	<ul>
	<li>Basic networking capabilities
		<ul>
			<li>Send messages</li>
			<li>Listen and respond (concurrently)</li>
			<li>On a custom port, if desired</li>
		</ul>
	</li>
	<li>Encrypted communications (RSA)</li>
	<li>Transparent settings storage</li>
	<li>UPnP forwarding (Linux, OSX)</li>
	</ul>
	
	<h2>
	<a id="working-on-it" class="anchor" href="#working-on-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>Working on it</h2>
	
	<ul>
	<li>Dedicated server mode</li>
	<li>More complete bounty definition</li>
	<li>More complete settings controls</li>
	<li>Windows dependency fixes
		<ul>
			<li>MiniUPNPc (compile-time error)</li>
		</ul>
	</li>
	</ul>
	
	<h2>
	<a id="future" class="anchor" href="#future" aria-hidden="true"><span class="octicon octicon-link"></span></a>Future</h2>
	
	<ul>
	<li>Coin control
	
	<ul>
	<li>Payment channel</li>
	<li>Secure wallet generation</li>
	<li>Secure wallet storage</li>
	</ul>
	</li>
	<li>Network discovery</li>
	<li>Sandboxed Execution</li>
	</ul>

</div>

<div id="issuesection">
	
	<h1>Open Issues</h1>
	
	<p>Submit an issue <a href="https://gitreports.com/issue/gappleto97/Senior-Project">here</a> if you do not have a GitHub account, or <a href="https://github.com/gappleto97/Senior-Project/issues/new">here</a> if you do.</p>
	
	<hr>

</div>

<h1>Footnotes</h1>

<hr>

<div id="footnotes"></div>

        </section>

        <aside id="sidebar">
          <a href="https://github.com/gappleto97/Senior-Project/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/gappleto97/Senior-Project/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/gappleto97/Senior-Project">This project</a> is maintained by <a href="https://github.com/gappleto97">gappleto97</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>. It also makes use of <a href="https://github.com/chjj/marked">marked.js</a> for markdown parsing, and <a href="http://prismjs.com">prism.js</a> for code highlighting. This page has been heavily modified since generation.</p>
        </aside>
      </div>
    </div>
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-69722974-3");
      pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
